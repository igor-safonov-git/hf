<!DOCTYPE html>
<html>
<head>
    <title>Table Render Test</title>
    <style>
        /* Copy styles from index.html */
        .table-wrapper {
            width: 100%;
            overflow-x: auto;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            margin-top: 2rem;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
            background-color: white;
        }
        
        .data-table thead {
            background-color: #f9fafb;
        }
        
        .data-table th {
            padding: 0.75rem 1rem;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            white-space: nowrap;
        }
        
        .data-table th.sortable {
            cursor: pointer;
            user-select: none;
            position: relative;
            padding-right: 2rem;
        }
        
        .data-table th.sortable:hover {
            background-color: #f3f4f6;
        }
        
        .data-table th.sortable::after {
            content: '↕';
            position: absolute;
            right: 0.75rem;
            opacity: 0.5;
        }
        
        .data-table th.sortable.desc::after {
            content: '↓';
            opacity: 1;
        }
        
        .data-table td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .data-table td.numeric {
            text-align: right;
            font-variant-numeric: tabular-nums;
        }
        
        .data-table tbody tr:hover {
            background-color: #f9fafb;
        }
        
        .data-table tbody tr:last-child td {
            border-bottom: none;
        }
        
        body {
            font-family: system-ui, -apple-system, sans-serif;
            padding: 2rem;
            background: #f3f4f6;
        }
        
        h1 {
            color: #1f2937;
            margin-bottom: 2rem;
        }
    </style>
</head>
<body>
    <h1>Table Implementation Test</h1>
    <div id="container"></div>
    
    <script>
        // Sample table data from our API response
        const tableData = {
            "columns": [
                {"key": "name", "label": "Название", "type": "text", "sortable": true},
                {"key": "count", "label": "Количество", "type": "number", "sortable": true},
                {"key": "percentage", "label": "Процент", "type": "percentage", "sortable": true}
            ],
            "rows": [
                {"name": "Анастасия Богач", "count": 20, "percentage": 33.9},
                {"name": "Киселев Вячеслав", "count": 11, "percentage": 18.6},
                {"name": "Антон Озорин", "count": 10, "percentage": 17.0},
                {"name": "Игорь Сафонов", "count": 7, "percentage": 11.9},
                {"name": "Михаил Танский", "count": 5, "percentage": 8.5}
            ],
            "metadata": {
                "total_rows": 5,
                "sorted_by": "count",
                "sort_order": "desc"
            }
        };
        
        // Copy renderTable function from index.html
        const renderTable = (tableData, container) => {
            container.innerHTML = '';
            
            const wrapper = document.createElement('div');
            wrapper.className = 'table-wrapper';
            
            const table = document.createElement('table');
            table.className = 'data-table';
            
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            
            tableData.columns.forEach(col => {
                const th = document.createElement('th');
                th.textContent = col.label;
                th.className = col.sortable ? 'sortable' : '';
                th.dataset.key = col.key;
                
                if (tableData.metadata?.sorted_by === col.key) {
                    th.className += ' ' + (tableData.metadata.sort_order || 'desc');
                }
                
                headerRow.appendChild(th);
            });
            
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            const tbody = document.createElement('tbody');
            
            tableData.rows.forEach(row => {
                const tr = document.createElement('tr');
                
                tableData.columns.forEach(col => {
                    const td = document.createElement('td');
                    const value = row[col.key];
                    
                    switch(col.type) {
                        case 'number':
                            td.textContent = value ? value.toLocaleString('ru-RU') : '0';
                            td.className = 'numeric';
                            break;
                        case 'percentage':
                            td.textContent = value ? `${value.toFixed(1)}%` : '0%';
                            td.className = 'numeric';
                            break;
                        default:
                            td.textContent = value || '';
                    }
                    
                    tr.appendChild(td);
                });
                
                tbody.appendChild(tr);
            });
            
            table.appendChild(tbody);
            wrapper.appendChild(table);
            container.appendChild(wrapper);
        };
        
        // Render the table
        const container = document.getElementById('container');
        renderTable(tableData, container);
    </script>
</body>
</html>